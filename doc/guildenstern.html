<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>guildenstern</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);


  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', "dark");
    toggleSwitch.checked = true;
  } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', "light");
    toggleSwitch.checked = false;
  } else {
    const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
    if (currentTheme) {
      document.documentElement.setAttribute('data-theme', currentTheme);

      if (currentTheme === 'dark') {
        toggleSwitch.checked = true;
      }
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">guildenstern</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#GuildenServer"
    title="GuildenServer {.inheritable.} = ref object
  tcpport*: Port               ## set when calling `serve`"><wbr />Guilden<wbr />Server<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#GuildenVars"
    title="GuildenVars {.inheritable.} = ref object
  gs*: GuildenServer
  clientid*: Clientid
  fd*: SocketHandle            ## fd = &quot;file descriptor&quot; (trad., of Unix folklore origin)
  recvbuffer*: StringStream    ## Contains the request
  bodystartpos*: int           ## Start index of body part in HTTP requests
  sendbuffer*: StringStream    ## Response data to send with `reply` or `sendToWs`"><wbr />Guilden<wbr />Vars<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#Clientid"
    title="Clientid = distinct int32"><wbr />Clientid<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#10" id="60">Consts</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#MaxHttpHeaderFields"
    title="MaxHttpHeaderFields = 25"><wbr />Max<wbr />Http<wbr />Header<wbr />Fields<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#MaxHttpHeaderValueLength"
    title="MaxHttpHeaderValueLength = 200"><wbr />Max<wbr />Http<wbr />Header<wbr />Value<wbr />Length<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#MaxRequestLength"
    title="MaxRequestLength = 1000"><wbr />Max<wbr />Request<wbr />Length<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#MaxResponseLength"
    title="MaxResponseLength = 100000"><wbr />Max<wbr />Response<wbr />Length<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#RcvTimeOut"
    title="RcvTimeOut = 5"><wbr />Rcv<wbr />Time<wbr />Out<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#serve%2CGuildenServer%2Cint"
    title="serve[T: GuildenVars](gs: GuildenServer; port: int)"><wbr />serve<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#signalSIGINT"
    title="signalSIGINT()"><wbr />signal<wbr />SIGINT<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerHttphandler%2CGuildenServer%2Cproc%28GuildenVars%29%2CopenArray%5Bstring%5D"
    title="registerHttphandler(gs: GuildenServer; callback: proc (gv: GuildenVars) {.gcsafe,
    nimcall, raises: [].}; headerfields: openArray[string] = [&quot;content-length&quot;])"><wbr />register<wbr />Httphandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerWshandler%2CGuildenServer%2Cproc%28GuildenVars%29"
    title="registerWshandler(gs: GuildenServer; callback: proc (gv: GuildenVars) {.gcsafe,
    nimcall, raises: [].})"><wbr />register<wbr />Wshandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerWsdisconnecthandler%2CGuildenServer%2Cproc%28GuildenVars%2Cbool%29"
    title="registerWsdisconnecthandler(gs: GuildenServer; callback: proc (gv: GuildenVars;
    closedbyclient: bool) {.gcsafe, nimcall, raises: [].})"><wbr />register<wbr />Wsdisconnecthandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerTimerhandler%2CGuildenServer%2Cproc%29%2Cint"
    title="registerTimerhandler(gs: GuildenServer;
                     callback: proc () {.gcsafe, nimcall, raises: [].};
                     intervalsecs: int)"><wbr />register<wbr />Timerhandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerErrorhandler%2CGuildenServer%2Cproc%28GuildenVars%2Cstring%29"
    title="registerErrorhandler(gs: GuildenServer; callback: proc (gv: GuildenVars; msg: string) {.
    gcsafe, nimcall, raises: [].})"><wbr />register<wbr />Errorhandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#registerShutdownhandler%2CGuildenServer%2Cproc%29"
    title="registerShutdownhandler(gs: GuildenServer;
                        callback: proc () {.gcsafe, nimcall, raises: [].})"><wbr />register<wbr />Shutdownhandler<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#upgradeHttpToWs%2CGuildenVars%2CClientid"
    title="upgradeHttpToWs(gv: GuildenVars; clientid: Clientid)"><wbr />upgrade<wbr />Http<wbr />To<wbr />Ws<span class="attachedType">Clientid</span></a></li>
  <li><a class="reference" href="#getPath%2CGuildenVars"
    title="getPath(gv: GuildenVars): string"><wbr />get<wbr />Path<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#isPath%2CGuildenVars%2Cstring"
    title="isPath(gv: GuildenVars; apath: string): bool"><wbr />is<wbr />Path<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#pathStarts%2CGuildenVars%2Cstring"
    title="pathStarts(gv: GuildenVars; pathstart: string): bool"><wbr />path<wbr />Starts<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#getMethod%2CGuildenVars"
    title="getMethod(gv: GuildenVars): string"><wbr />get<wbr />Method<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#isMethod%2CGuildenVars%2Cstring"
    title="isMethod(gv: GuildenVars; amethod: string): bool"><wbr />is<wbr />Method<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#getHeader%2CGuildenVars%2Cstring"
    title="getHeader(gv: GuildenVars; header: string): string"><wbr />get<wbr />Header<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#getBody%2CGuildenVars"
    title="getBody(gv: GuildenVars): string"><wbr />get<wbr />Body<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2Cstring"
    title="reply(gv: GuildenVars; code: HttpCode; body: string; headers = &quot;&quot;)"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2CopenArray%5Bstring%5D"
    title="reply(gv: GuildenVars; code: HttpCode; body: string; headers: openArray[string])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2Cseq%5Bstring%5D"
    title="reply(gv: GuildenVars; code: HttpCode; body: string; headers: seq[string])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2CopenArray%5Bseq%5Bstring%5D%5D"
    title="reply(gv: GuildenVars; code: HttpCode; body: string; headers: openArray[seq[string]])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2Cstring"
    title="reply(gv: GuildenVars; body: string; code = Http200)"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#replyHeaders%2CGuildenVars%2CopenArray%5Bstring%5D%2CHttpCode"
    title="replyHeaders(gv: GuildenVars; headers: openArray[string]; code: HttpCode = Http200)"><wbr />reply<wbr />Headers<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#replyHeaders%2CGuildenVars%2Cseq%5Bstring%5D%2CHttpCode"
    title="replyHeaders(gv: GuildenVars; headers: seq[string]; code: HttpCode = Http200)"><wbr />reply<wbr />Headers<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#replyHeaders%2CGuildenVars%2CopenArray%5Bseq%5Bstring%5D%5D%2CHttpCode"
    title="replyHeaders(gv: GuildenVars; headers: openArray[seq[string]];
             code: HttpCode = Http200)"><wbr />reply<wbr />Headers<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CopenArray%5Bstring%5D"
    title="reply(gv: GuildenVars; headers: openArray[string])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2Cseq%5Bstring%5D"
    title="reply(gv: GuildenVars; headers: seq[string])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#reply%2CGuildenVars%2CopenArray%5Bseq%5Bstring%5D%5D"
    title="reply(gv: GuildenVars; headers: openArray[seq[string]])"><wbr />reply<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#replyCode%2CGuildenVars%2CHttpCode"
    title="replyCode(gv: GuildenVars; code: HttpCode)"><wbr />reply<wbr />Code<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#writeToWs%2CGuildenVars%2CStringStream"
    title="writeToWs(gv: GuildenVars; toSocket = -2147483647.SocketHandle;
          text: StringStream = nil): bool"><wbr />write<wbr />To<wbr />Ws<span class="attachedType"></span></a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"><p>genuinely multithreading integrated HTTP/1.1 + WebSocket v13 Server</p>
<p>for POSIX-compliant OSes</p>
</p>
  <div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="GuildenServer"></a>
<dt><pre><a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inheritable</span></span><span class="Other">.}</span></span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span>
  <span class="Identifier">tcpport</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Port</span>               <span class="Comment">## set when calling `serve`</span>
  </pre></dt>
<dd>

<p>Contains global variables.<br />This is available in GuildenVars via <tt class="docutils literal"><span class="pre">gs</span></tt> property.<br />Inherit and add custom properties as needed.<br /></p>

</dd>
<a id="GuildenVars"></a>
<dt><pre><a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inheritable</span></span><span class="Other">.}</span></span> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span>
  <span class="Identifier">gs</span><span class="Operator">*</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a>
  <span class="Identifier">clientid</span><span class="Operator">*</span><span class="Other">:</span> <a href="guildenstern.html#Clientid"><span class="Identifier">Clientid</span></a>
  <span class="Identifier">fd</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">SocketHandle</span>            <span class="Comment">## fd = &quot;file descriptor&quot; (trad., of Unix folklore origin)</span>
  <span class="Identifier">recvbuffer</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">StringStream</span>    <span class="Comment">## Contains the request</span>
  <span class="Identifier">bodystartpos</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>           <span class="Comment">## Start index of body part in HTTP requests</span>
  <span class="Identifier">sendbuffer</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">StringStream</span>    <span class="Comment">## Response data to send with `reply` or `sendToWs`</span>
  </pre></dt>
<dd>

<p>Contains thread-local variables, acting as the context for an incoming request.<br />This is available in callbacks as parameter.<br />Inherit and add custom properties as needed.<br /></p>

</dd>
<a id="Clientid"></a>
<dt><pre><a href="guildenstern.html#Clientid"><span class="Identifier">Clientid</span></a> <span class="Other">=</span> <span class="Keyword">distinct</span> <span class="Identifier">int32</span></pre></dt>
<dd>

<p>Value to identify WebSocket client of the request.<br />Set this in upgradeHttpToWs proc and it will thereafter be available as <tt class="docutils literal"><span class="pre">clientid</span></tt> in GuildenVars.<br /></p>

</dd>

</dl></div>
<div class="section" id="10">
<h1><a class="toc-backref" href="#10">Consts</a></h1>
<dl class="item">
<a id="MaxHttpHeaderFields"></a>
<dt><pre><a href="guildenstern.html#MaxHttpHeaderFields"><span class="Identifier">MaxHttpHeaderFields</span></a> <span class="Other">=</span> <span class="DecNumber">25</span></pre></dt>
<dd>

Compile time define pragma to set maximum number of captured http headers.

</dd>
<a id="MaxHttpHeaderValueLength"></a>
<dt><pre><a href="guildenstern.html#MaxHttpHeaderValueLength"><span class="Identifier">MaxHttpHeaderValueLength</span></a> <span class="Other">=</span> <span class="DecNumber">200</span></pre></dt>
<dd>

Compile time define pragma to set maximum length for any http header value.

</dd>
<a id="MaxRequestLength"></a>
<dt><pre><a href="guildenstern.html#MaxRequestLength"><span class="Identifier">MaxRequestLength</span></a> <span class="Other">=</span> <span class="DecNumber">1000</span></pre></dt>
<dd>

Compile time define pragma to limit size of receivable requests (maximum size of <tt class="docutils literal"><span class="pre">recvbuffer</span></tt>).

</dd>
<a id="MaxResponseLength"></a>
<dt><pre><a href="guildenstern.html#MaxResponseLength"><span class="Identifier">MaxResponseLength</span></a> <span class="Other">=</span> <span class="DecNumber">100000</span></pre></dt>
<dd>

Compile time define pragma to limit size of sendable responses (maximum size of <tt class="docutils literal"><span class="pre">sendbuffer</span></tt>).

</dd>
<a id="RcvTimeOut"></a>
<dt><pre><a href="guildenstern.html#RcvTimeOut"><span class="Identifier">RcvTimeOut</span></a> <span class="Other">=</span> <span class="DecNumber">5</span></pre></dt>
<dd>

Compile time define pragma to  set sockets timeout SO_RCVTIMEO, <a class="reference external" href="https://linux.die.net/man/7/socket">https://linux.die.net/man/7/socket</a>

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="serve,GuildenServer,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#serve%2CGuildenServer%2Cint"><span class="Identifier">serve</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">]</span><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span></pre></dt>
<dd>

<p>Starts the server main loop which runs until SIGINT is received.</p>
<p>Give type of GuildenVars so that you can use your own customized request context. (Note: method call syntax does not work, see <a class="reference external" href="https://github.com/nim-lang/Nim/issues/14254">#14254</a>)</p>
<p>Give tcp port as parameter.</p>
<p><strong>Example:</strong></p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">guildenstern</span>

<span class="Keyword">type</span>
  <span class="Identifier">MyGuildenServer</span> <span class="Operator">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">GuildenServer</span>
    <span class="Identifier">customserverproperty</span><span class="Punctuation">:</span> <span class="Identifier">string</span>
  
  <span class="Identifier">MyGuildenVars</span> <span class="Operator">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">GuildenVars</span>
    <span class="Identifier">customcontextproperty</span><span class="Punctuation">:</span> <span class="Identifier">string</span>

<span class="Keyword">proc</span> <span class="Identifier">onRequest</span><span class="Punctuation">(</span><span class="Identifier">gv</span><span class="Punctuation">:</span> <span class="Identifier">MyGuildenVars</span><span class="Punctuation">)</span> <span class="Operator">=</span>
  <span class="Identifier">gv</span><span class="Operator">.</span><span class="Identifier">customcontextproperty</span> <span class="Operator">=</span> <span class="StringLit">&quot;world&quot;</span>
  <span class="Identifier">gv</span><span class="Operator">.</span><span class="Identifier">reply</span><span class="Punctuation">(</span><span class="Punctuation">(</span><span class="Punctuation">(</span><span class="Identifier">MyGuildenServer</span><span class="Punctuation">)</span><span class="Identifier">gv</span><span class="Operator">.</span><span class="Identifier">gs</span><span class="Punctuation">)</span><span class="Operator">.</span><span class="Identifier">customserverproperty</span> <span class="Operator">&amp;</span> <span class="Identifier">gv</span><span class="Operator">.</span><span class="Identifier">customcontextproperty</span><span class="Punctuation">)</span>

<span class="Keyword">let</span> <span class="Identifier">server</span> <span class="Operator">=</span> <span class="Identifier">new</span> <span class="Identifier">MyGuildenServer</span>
<span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">customserverproperty</span> <span class="Operator">=</span> <span class="StringLit">&quot;hello,&quot;</span>
<span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">registerHttphandler</span><span class="Punctuation">(</span><span class="Identifier">onRequest</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
<span class="Identifier">serve</span><span class="Punctuation">[</span><span class="Identifier">MyGuildenVars</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="Identifier">server</span><span class="Punctuation">,</span> <span class="DecNumber">8080</span><span class="Punctuation">)</span></pre>

</dd>
<a id="signalSIGINT"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#signalSIGINT"><span class="Identifier">signalSIGINT</span></a><span class="Other">(</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Sends Ctrl-C to current process which is caught by GuildenServer and graceful shutdown is commenced.

</dd>
<a id="registerHttphandler,GuildenServer,proc(GuildenVars),openArray[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerHttphandler%2CGuildenServer%2Cproc%28GuildenVars%29%2CopenArray%5Bstring%5D"><span class="Identifier">registerHttphandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span> <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span>
    <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">;</span> <span class="Identifier">headerfields</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span> <span class="Other">=</span> <span class="Other">[</span><span class="StringLit">&quot;content-length&quot;</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to handle incoming http requests. Give list of header field names to capture. If body is to be received, &quot;content-length&quot; must be one of the capturable fields. Receiving duplicate header fields is not supported.

</dd>
<a id="registerWshandler,GuildenServer,proc(GuildenVars)"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerWshandler%2CGuildenServer%2Cproc%28GuildenVars%29"><span class="Identifier">registerWshandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span> <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span>
    <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to handle incoming WebSocket requests.

</dd>
<a id="registerWsdisconnecthandler,GuildenServer,proc(GuildenVars,bool)"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerWsdisconnecthandler%2CGuildenServer%2Cproc%28GuildenVars%2Cbool%29"><span class="Identifier">registerWsdisconnecthandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span> <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span>
    <span class="Identifier">closedbyclient</span><span class="Other">:</span> <span class="Identifier">bool</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to handle disconnecting WebSocket requests. If closedbyclient == true, client closed the session and usually must not be allowed to login again without credentials. If closedbyclient == false, socket was lost due to a network problem and usually the client will try to reconnect soon.

</dd>
<a id="registerTimerhandler,GuildenServer,proc),int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerTimerhandler%2CGuildenServer%2Cproc%29%2Cint"><span class="Identifier">registerTimerhandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span>
                         <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">;</span>
                         <span class="Identifier">intervalsecs</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to handle timer events with given interval in seconds.

</dd>
<a id="registerErrorhandler,GuildenServer,proc(GuildenVars,string)"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerErrorhandler%2CGuildenServer%2Cproc%28GuildenVars%2Cstring%29"><span class="Identifier">registerErrorhandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span> <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span>
    <span class="Identifier">msg</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to handle error conditions. If serverstate is set to Maintenance, all http and ws requests will call this proc instead of their normal handler. If proc is called due to a genuine error, error message is available in msg.

</dd>
<a id="registerShutdownhandler,GuildenServer,proc)"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#registerShutdownhandler%2CGuildenServer%2Cproc%29"><span class="Identifier">registerShutdownhandler</span></a><span class="Other">(</span><span class="Identifier">gs</span><span class="Other">:</span> <a href="guildenstern.html#GuildenServer"><span class="Identifier">GuildenServer</span></a><span class="Other">;</span>
                            <span class="Identifier">callback</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">nimcall</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Registers the callback procedure to perform application shutdown like closing database connections.

</dd>
<a id="upgradeHttpToWs,GuildenVars,Clientid"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#upgradeHttpToWs%2CGuildenVars%2CClientid"><span class="Identifier">upgradeHttpToWs</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">clientid</span><span class="Other">:</span> <a href="guildenstern.html#Clientid"><span class="Identifier">Clientid</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Upgrades the current file descriptor to WebSocket protocol. Give a clientid that allows identification of the connected user. Note that GuildenStern does not offer a way to get <tt class="docutils literal"><span class="pre">fd</span></tt> s of connected clients, you have to store these mappings yourself.

</dd>
<a id="getPath,GuildenVars"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getPath%2CGuildenVars"><span class="Identifier">getPath</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns deep copy of http path.

</dd>
<a id="isPath,GuildenVars,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#isPath%2CGuildenVars%2Cstring"><span class="Identifier">isPath</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">apath</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Checks if http path is apath.

</dd>
<a id="pathStarts,GuildenVars,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#pathStarts%2CGuildenVars%2Cstring"><span class="Identifier">pathStarts</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">pathstart</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Checks if http path starts with pathstart.

</dd>
<a id="getMethod,GuildenVars"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getMethod%2CGuildenVars"><span class="Identifier">getMethod</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns deep copy of http method.

</dd>
<a id="isMethod,GuildenVars,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#isMethod%2CGuildenVars%2Cstring"><span class="Identifier">isMethod</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">amethod</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Checks if http method is amethod.

</dd>
<a id="getHeader,GuildenVars,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getHeader%2CGuildenVars%2Cstring"><span class="Identifier">getHeader</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">header</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns value of header.

</dd>
<a id="getBody,GuildenVars"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getBody%2CGuildenVars"><span class="Identifier">getBody</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns deep copy of http body (avoid in production).

</dd>
<a id="reply,GuildenVars,HttpCode,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2Cstring"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">headers</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="reply,GuildenVars,HttpCode,string,openArray[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2CopenArray%5Bstring%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="reply,GuildenVars,HttpCode,string,seq[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2Cseq%5Bstring%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="reply,GuildenVars,HttpCode,string,openArray[seq[string]]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CHttpCode%2Cstring%2CopenArray%5Bseq%5Bstring%5D%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span>
          <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="reply,GuildenVars,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2Cstring"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">code</span> <span class="Other">=</span> <span class="Identifier">Http200</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="replyHeaders,GuildenVars,openArray[string],HttpCode"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#replyHeaders%2CGuildenVars%2CopenArray%5Bstring%5D%2CHttpCode"><span class="Identifier">replyHeaders</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">;</span>
                 <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span> <span class="Other">=</span> <span class="Identifier">Http200</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="replyHeaders,GuildenVars,seq[string],HttpCode"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#replyHeaders%2CGuildenVars%2Cseq%5Bstring%5D%2CHttpCode"><span class="Identifier">replyHeaders</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span> <span class="Other">=</span> <span class="Identifier">Http200</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="replyHeaders,GuildenVars,openArray[seq[string]],HttpCode"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#replyHeaders%2CGuildenVars%2CopenArray%5Bseq%5Bstring%5D%5D%2CHttpCode"><span class="Identifier">replyHeaders</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">]</span><span class="Other">;</span>
                 <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span> <span class="Other">=</span> <span class="Identifier">Http200</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="reply,GuildenVars,openArray[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CopenArray%5Bstring%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Responds with contents of sendbuffer

</dd>
<a id="reply,GuildenVars,seq[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2Cseq%5Bstring%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Responds with contents of sendbuffer

</dd>
<a id="reply,GuildenVars,openArray[seq[string]]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#reply%2CGuildenVars%2CopenArray%5Bseq%5Bstring%5D%5D"><span class="Identifier">reply</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Responds with contents of sendbuffer

</dd>
<a id="replyCode,GuildenVars,HttpCode"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#replyCode%2CGuildenVars%2CHttpCode"><span class="Identifier">replyCode</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">code</span><span class="Other">:</span> <span class="Identifier">HttpCode</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>



</dd>
<a id="writeToWs,GuildenVars,StringStream"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#writeToWs%2CGuildenVars%2CStringStream"><span class="Identifier">writeToWs</span></a><span class="Other">(</span><span class="Identifier">gv</span><span class="Other">:</span> <a href="guildenstern.html#GuildenVars"><span class="Identifier">GuildenVars</span></a><span class="Other">;</span> <span class="Identifier">toSocket</span> <span class="Other">=</span> <span class="DecNumber">-2147483647</span><span class="Other">.</span><span class="Identifier">SocketHandle</span><span class="Other">;</span>
              <span class="Identifier">text</span><span class="Other">:</span> <span class="Identifier">StringStream</span> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Sends text data to a websocket.</p>
<p>If text parameter is not given, sends contents of <tt class="docutils literal"><span class="pre">sendbuffer</span></tt>.</p>
<p>If toSocket parameter is not given, replies back to socket that made the request.</p>
<p>Returns false if sending failed.</p>
<p>Do not write to same socket from many threads in parallel, use some serialization strategy like locking.</p>


</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-05-11 11:16:14 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
